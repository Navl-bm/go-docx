# godocx - Утилита для работы с DOCX в Go

[![Go Version](https://img.shields.io/badge/go-1.20-blue.svg)](https://golang.org)

Библиотека для программной генерации и модификации DOCX-документов с сохранением форматирования. Позволяет безопасно заменять шаблоны в структуре документа.

> Я хотел использовать для этого unidoc/unioffice, но он работает после регистрации на их сайте, поэтому сделал быстрые замены сам для себя и под свои задачи, если вам пригодится - используйте. 
В вашем шаблоне должны быть заглушки в формате ```{ваше_имя_заглушки}```, которые будет заменены в процессе выполнения
  
---

## Основные возможности

- Генерация новых документов из шаблонов
- **Безопасная замена текста** с сохранением пробелов, переносов и структуры XML
- Сохранение оригинального форматирования и стилей
- В зависимости от переданных данных применяются разные вставки (будет показано в примере)
  
---

## Установка

```bash
go get github.com/Navl-bm/go-docx
```

## Пример использования

```bash
package main

import (
	"fmt"

	godocx "github.com/Navl-bm/go-docx"
)

func main() {
	replacements := map[string]interface{}{
		"{data1}": "text1",
		"{data2}": "text2",
		"{data3}": "text3-1\ntext3-2\ntext3-3",
		"{data4}": []string{"text4-1", "text4-2", "text4-3"},
		"{data5}": "text5",
		"{data6}": "text6",
	}

	outputPath, err := godocx.GenerateDocx("template.docx", replacements)
	if err != nil {
		fmt.Println("Ошибка:", err)
	} else {
		fmt.Println("Создан документ:", outputPath)
	}
}
```

## Важное замечание
- Если вам требуется вставить обычный текст используйте ```"{data1}": "text1"```
- Если вам требуется вставить несколько абазцев (enter) используйте ```"{data4}": []string{"text4-1", "text4-2", "text4-3"}```
- Если вам требуется вставить несколько строк в один абзац (shift+enter) используйте ```"{data3}": "text3-1\ntext3-2\ntext3-3"```
